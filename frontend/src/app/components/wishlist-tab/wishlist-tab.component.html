<main class="main-content wishlist-content">
  <header class="wishlist-header">
    <h1 class="wishlist-title">Wishlist</h1>
    @if (wishlist().length > 0 && dataReady()) {
      <span class="wishlist-count">{{ wishlist().length }}</span>
    }
  </header>

  @if (wishlistLoading() || !dataReady()) {
    <div class="skeleton-list">
      @for (i of [1, 2, 3, 4, 5]; track i) {
        <app-skeleton-card />
      }
    </div>
  }

  @if (wishlistError() && !wishlistLoading()) {
    <div class="error-container">
      <p class="error-text">{{ wishlistError() }}</p>
      <button mat-button (click)="loadWishlist()">Попробовать снова</button>
    </div>
  }

  @if (!wishlistLoading() && !wishlistError() && wishlist().length === 0) {
    <div class="empty-container">
      <mat-icon class="empty-icon">bookmark_border</mat-icon>
      <p class="empty-text">Wishlist пуст</p>
      <p class="empty-hint">Добавляйте табаки из поиска</p>
    </div>
  }

  @if (!wishlistLoading() && !wishlistError() && wishlist().length > 0 && dataReady()) {
    <div class="wishlist-list">
      @for (item of wishlist(); track item.id) {
        <app-tobacco-card
          [tobacco]="item.tobacco"
          [wishlistItem]="item"
          [tobaccoName]="getTobaccoName(item.tobaccoId)"
          [brandName]="getBrandNameByTobaccoId(item.tobaccoId)"
          [lineName]="getLineNameByTobaccoId(item.tobaccoId)"
          [imageUrl]="getTobaccoImageUrl(item.tobaccoId)"
          [formattedDate]="formatDate(item.createdAt)"
          [removing]="removingFromWishlist().has(item.id)"
          [withCheckmark]="itemsWithCheckmark().has(item.id)"
          [inWishlist]="true"
          (cardClick)="onCardClick($event)"
          (removeFromWishlist)="onMarkAsPurchased($event)"
        />
      }
    </div>
  }
</main>
