<div
  class="tobacco-card"
  [class.removing]="removing()"
  [class.with-checkmark]="withCheckmark()"
>
  <div class="tobacco-image-container">
    <img
      [ngSrc]="displayImageUrl()"
      [alt]="displayTobaccoName()"
      class="tobacco-image"
      fill
      loading="lazy"
      (error)="onImageError($event)"
    />
  </div>
  <div class="tobacco-info">
    <h3 class="tobacco-name">{{ displayTobaccoName() }}</h3>
    <p class="tobacco-brand">{{ displayBrandName() }}</p>
    @if (displayLineName()) {
      <p class="tobacco-line">{{ displayLineName() }}</p>
    }
    @if (showRating()) {
      <p class="tobacco-rating">
        {{ displayRatingFormatted() }} ({{ displayRatingsCount() }})
      </p>
    }
    @if (showDate()) {
      <p class="tobacco-date">{{ displayDate() }}</p>
    }
  </div>
  <button
    mat-icon-button
    class="add-button"
    [class.in-wishlist]="inWishlist()"
    (click)="onButtonClick()"
    [disabled]="isLoading()"
  >
    @if (!isLoading()) {
      @if (inWishlist()) {
        <mat-icon>check_circle</mat-icon>
      } @else {
        <mat-icon>add</mat-icon>
      }
    } @else {
      <mat-spinner diameter="20" class="button-spinner"></mat-spinner>
    }
  </button>
  @if (withCheckmark()) {
    <div class="checkmark-overlay">
      <mat-icon class="checkmark-icon">check</mat-icon>
    </div>
  }
</div>
